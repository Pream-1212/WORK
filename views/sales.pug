extends edit_layout



block content

  // Page Header
  h1.text-center.mt-4 Our Movements

  main.container.mt-4
    h2 Sales Information
    p
      i Welcome to our sales page!
      |  Here you will find our latest offers.

    h3.mt-4 Add New Sale
    .form-card.card.shadow.mx-auto.mb-5.p-4(style="max-width:500px")
      form#addSaleForm(action='/Addsale', method='post')
        .mb-3
          label(for="saleDate") Date:
          input#saleDate.form-control(type="date", name="date", required)
        .mb-3
          label(for="customer") Customer Name:
          input#customer.form-control(type="text", placeholder="Customer Name", name="name", required)
        .mb-3
          label.form-label Product Name
          select#productName.form-control(type='text', name='productName', required='')
            option(value='') -- Select Product --
            option(value='Officefurniture') Officefurniture
            option(value='Softwood') Softwood
            option(value='Hardwood') Hardwood
            option(value='Cupboards') Cupboards
            option(value='Beds') Beds
            option(value='Cabinets') Cabinets
            option(value='Poles') Poles
            option(value='Woodchips') Woodchips
            option(value='Diningtables') Diningtables
            option(value='Wardrobes') Wardrobes
            if stocks && stocks.length
              each stock in stocks
                option(value=stock.productName)= stock.productName
        .mb-3
          label.form-label Product Type
          select#productType.form-control(name='productType', required)
            option(value='') -- Select Product --
            option(value='Wood') Wood
            option(value='Furniture') Furniture
        .mb-3
          label(for="quantity") Quantity:
          input#quantity.form-control(type="number", placeholder="Quantity", name="quantity",id="quantity", required)
        .mb-3
          label(for="unitprice") Unit Price: UGX
          input#price.form-control(type="text", placeholder="Unit Price", name="unitPrice",id="unitPrice", required)
        .mb-3
          label.payment Payment Type:
          select.form-control#paymentType(name="payment",id="payment", required)
            option(value='') -- Select Payment --
            option(value="cheque") Cheque
            option(value="cash") Cash
            option(value="bankoverdraft") Bank Overdraft
            option(value="banktransfer") Bank Transfer
            option(value="paypal") PayPal
        .mb-3
          label.form-label Transport Required?
          select#transportOption.form-control(name='transportOption',id="transportOption",required)
            option(value='no') No
            option(value='yes') Yes

        // Hidden fields to store computed values
        input#transportCharge(type='hidden', name='transportCharge',id="transportCharge")
        input#totalPrice(type='hidden', name='totalPrice',id="totalPrice")
        .mb-3
          label.form-label Delivery Time
          .form-check
            input.form-check-input#delivery1(type="radio", name="delivery", value="1-2 weeks", required)
            label.form-check-label(for="delivery1") 1-2 weeks delivery
          .form-check
            input.form-check-input#delivery2(type="radio", name="delivery", value="3-5 days")
            label.form-check-label(for="delivery2") 3-5 days delivery
          .form-check
            input.form-check-input#delivery3(type="radio", name="delivery", value="Same day")
            label.form-check-label(for="delivery3") Same day delivery

        button.btn.btn-success.mt-3(type="submit") Add Sale

    // Info Row
    .row.mt-5
      .col.order-last
        h3
          i Possible payment types
        p.
          Pay card (cheque) at our office. Pay with cash at our office. 
          Pay us on internet via our banking service (bank overdraft) and transfer account to invoice. 
          Via our PayPal.
      .col
        h3 Returns
        p
          | To make returns pass via email: mwfco.org, with subject:
          u
            i Returns
        p View Returns Policy || Returns are allowed without damages and contact us via our email for such issues or call us directly if not responded immediately.
      .col.order-first
        h3
          i Customers are highly considered
        p
          | We offer transport to our customers. Customers pay 5% + total price.
          i Some of our products are imported from US, China and Denmark

    // Dashboard Image
    img.img-fluid.mx-auto.d-block.mt-4(
      src="/images/image.png",
      width="300px",
      height="200px",
      alt="Dashboard Image"
    )

  // Scripts
  script(src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.8/dist/js/bootstrap.bundle.min.js")
  // Script to calculate transportCharge and totalPrice
  script.
    const quantityInput = document.getElementById('quantity');
    const unitPriceInput = document.getElementById('unitPrice');
    const transportOption = document.getElementById('transportOption');
    const transportInput = document.getElementById('transportCharge');
    const totalInput = document.getElementById('totalPrice');

    function calculateTotal() {
      const qty = parseFloat(quantityInput.value) || 0;
      const price = parseFloat(unitPriceInput.value) || 0;
      let total = qty * price;
      let transport = 0;

      if (transportOption.value === 'yes') {
        transport = total * 0.05;
        total += transport;
      }

      transportInput.value = transport;
      totalInput.value = total;
    }

    quantityInput.addEventListener('input', calculateTotal);
    unitPriceInput.addEventListener('input', calculateTotal);
    transportOption.addEventListener('change', calculateTotal);
